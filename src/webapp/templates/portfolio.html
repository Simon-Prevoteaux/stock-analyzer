{% extends "base.html" %}

{% block title %}Portfolio{% endblock %}

{% block content %}
<h1>My Portfolio</h1>

{% if stocks %}
<div class="table-container">
    <table class="stock-table">
        <thead>
            <tr>
                <th>Ticker</th>
                <th>Company</th>
                <th>Current Price</th>
                <th>Market Cap</th>
                <th>P/E</th>
                <th>P/S</th>
                <th>PEG Avg</th>
                <th>Growth</th>
                <th>Risk Level</th>
                <th>Added</th>
                <th>Notes</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for stock in stocks %}
            <tr>
                <td><a href="{{ url_for('core.stock_detail', ticker=stock.ticker) }}">{{ stock.ticker }}</a></td>
                <td>{{ stock.company_name }}</td>
                <td>${{ stock.current_price }}</td>
                <td>{{ stock.market_cap|format_number }}</td>
                <td>{{ stock.pe_ratio|format_ratio }}</td>
                <td>{{ stock.ps_ratio|format_ratio }}</td>
                <td>
                    {% if stock.peg_average %}
                        <span style="color: {% if stock.peg_average < 1 %}#90EE90{% elif stock.peg_average <= 2 %}#ffd700{% else %}#ff6b6b{% endif %};">
                            {{ "%.2f"|format(stock.peg_average) }}
                        </span>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>{{ stock.revenue_growth|format_percent }}</td>
                <td><span class="risk-badge risk-{{ stock.risk_level|lower|replace(' ', '-') }}">{{ stock.risk_level }}</span></td>
                <td>{{ stock.added_date }}</td>
                <td>{{ stock.notes }}</td>
                <td>
                    <form method="POST" action="{{ url_for('portfolio.remove_from_portfolio', ticker=stock.ticker) }}" class="form-inline">
                        <button type="submit" class="btn btn-sm btn-danger">Remove</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p class="no-results">Your portfolio is empty. Add stocks from the <a href="{{ url_for('core.screener') }}">screener</a>.</p>
{% endif %}
{% endblock %}
